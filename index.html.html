<!--
Suporte-QR-Impressoras.html
Versão: Completa (single-file) — inclui 50 problemas
-->

<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Suporte Rápido - Impressora</title>
  <style>
    :root{font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;}
    body{margin:0;padding:16px;background:#f4f6f8;color:#12202b}
    .card{background:#fff;border-radius:12px;padding:16px;box-shadow:0 6px 18px rgba(16,24,40,0.08);max-width:720px;margin:12px auto}
    h1{font-size:18px;margin:0 0 8px}
    p.lead{margin:0 0 16px;color:#334155}
    label{font-weight:600;font-size:13px;display:block;margin:12px 0 6px}
    select,input[type=text],textarea{width:100%;padding:10px;border:1px solid #e2e8f0;border-radius:8px;font-size:14px}
    button{padding:12px 14px;border-radius:10px;border:0;font-weight:700;background:#0b63d6;color:#fff;font-size:15px;cursor:pointer}
    button.ghost{background:transparent;color:#0b63d6;border:1px solid #cfe0ff}
    .solution{background:#f8fafc;padding:12px;border-radius:8px;margin-top:10px}
    .steps{margin:8px 0;padding-left:18px}
    .row{display:flex;gap:8px}
    .small{font-size:13px;color:#475569}
    .muted{color:#64748b;font-size:13px}
    .footer{font-size:13px;color:#475569;margin-top:12px}
    .center{text-align:center}
    @media (max-width:520px){.row{flex-direction:column}}
    footer{margin-top:18px;text-align:center;color:#475569;font-size:13px}
  </style>
</head>
<body>
  <div class="card">
    <h1>Suporte rápido — Impressora</h1>
    <p class="lead">Escaneie o QR na impressora, verifique a sugestão e, se não resolver, abra o chamado no ServiceNow pelo seu celular.</p>

    <div id="printerInfo" class="muted" aria-live="polite"></div>

    <label for="issueSelect">Selecione o problema (ou digite abaixo)</label>
    <select id="issueSelect">
      <option value="">— escolher —</option>
    </select>

    <label for="customIssue">Ou descreva o problema (texto livre)</label>
    <input id="customIssue" type="text" placeholder="Ex: Impressora imprimindo borrado, erro 50.2, atolamento..." />

    <div style="margin-top:10px;" class="row">
      <button id="searchBtn">Ver soluções</button>
      <button id="clearBtn" class="ghost">Limpar</button>
    </div>

    <div id="result" style="display:none">
      <div class="solution">
        <div class="small" id="matchTitle"></div>
        <div id="matchSteps" class="steps"></div>
        <div style="margin-top:8px" class="row">
          <button id="resolvedYes" class="ghost">Resolvido</button>
          <button id="resolvedNo">Não resolveu — Abrir chamado</button>
        </div>
      </div>

      <div id="callActions" style="display:none;margin-top:12px">
        <label class="small">Observação (opcional)</label>
        <div class="row" style="margin-bottom:8px">
          <input id="obs" type="text" placeholder="Observação (ex: usuário preferiu não tentar)" />
        </div>
        <div class="row">
          <button id="openSN">Abrir chamado no ServiceNow</button>
        </div>
      </div>

    </div>

  </div>

  <footer>Desenvolvido por Phablo Salazar - 2025</footer>

  <script>
    const SERVICENOW_URL = 'https://suzanoprod.service-now.com/suzano_ti_vc?id=sc_cat_item&sys_id=c3df8aeddb89e74439e4a19b8a96197d';

    // Base com 50 problemas comuns
    const KB = [
      { id: 'jam', title: 'Atolamento na bandeja', keywords: ['atolamento','bandeja','papel preso'], steps: ['Retire o papel','Alinhe as folhas','Não ultrapasse a guia'] },
      { id: 'fuser_jam', title: 'Papel preso no fusor', keywords: ['fusor'], steps: ['Abra tampa traseira','Puxe suavemente','Remova papel'] },
      { id: 'double_feed', title: 'Alimentação dupla', keywords: ['duas folhas','alimentação dupla'], steps: ['Retire e ventile o papel','Ajuste guias laterais'] },
      { id: 'moist_paper', title: 'Papel úmido enrugando', keywords: ['papel úmido','molhado'], steps: ['Troque por papel seco','Guarde resma fechada'] },
      { id: 'not_recognized', title: 'Papel não reconhecido', keywords: ['papel não reconhecido'], steps: ['Ajuste tipo de papel no driver'] },
      { id: 'thick_paper', title: 'Papel grosso travando', keywords: ['papel grosso'], steps: ['Use bandeja manual','Selecione cartão no driver'] },
      { id: 'skew_feed', title: 'Papel puxando torto', keywords: ['puxando torto'], steps: ['Ajuste guia lateral da bandeja'] },
      { id: 'no_paper', title: 'Erro: Sem papel', keywords: ['sem papel'], steps: ['Recoloque papel','Verifique sensores'] },
      { id: 'duplex_jam', title: 'Enrosco no duplex', keywords: ['duplex'], steps: ['Limpe roletes traseiros com pano úmido'] },
      { id: 'torn_paper', title: 'Papel rasgado dentro', keywords: ['rasgado'], steps: ['Remova pedaços restantes com cuidado'] },
      { id: 'toner_low', title: 'Mensagem toner baixo', keywords: ['toner baixo'], steps: ['Retire e recoloque','Agite levemente'] },
      { id: 'toner_smear', title: 'Toner borrando', keywords: ['borrando'], steps: ['Limpe fusor','Troque cartucho'] },
      { id: 'black_page', title: 'Folha toda preta', keywords: ['toda preta'], steps: ['Substitua cartucho'] },
      { id: 'white_lines', title: 'Falha linhas brancas', keywords: ['linhas brancas'], steps: ['Agite cartucho','Troque se persistir'] },
      { id: 'cart_not_recognized', title: 'Cartucho não reconhecido', keywords: ['cartucho não reconhecido'], steps: ['Retire, limpe contatos','Recoloque cartucho'] },
      { id: 'incompatible_cart', title: 'Cartucho incompatível', keywords: ['cartucho incompatível'], steps: ['Verifique compatibilidade'] },
      { id: 'faint_print', title: 'Impressão desbotada', keywords: ['clara','desbotada'], steps: ['Ajuste densidade','Troque toner'] },
      { id: 'repeated_marks', title: 'Manchas repetidas', keywords: ['manchas'], steps: ['Troque fusor ou cilindro'] },
      { id: 'replace_cart', title: 'Erro substituir cartucho', keywords: ['substituir cartucho'], steps: ['Reset impressora','Troque chip'] },
      { id: 'toner_leak', title: 'Vazamento toner', keywords: ['vazamento'], steps: ['Limpe pó','Substitua cartucho'] },
      { id: 'wifi_fail', title: 'Não conecta Wi-Fi', keywords: ['wifi','sem rede'], steps: ['Reconfigure Wi-Fi','Use software oficial'] },
      { id: 'usb_fail', title: 'Cabo USB não reconhecido', keywords: ['usb'], steps: ['Troque porta','Troque cabo'] },
      { id: 'lan_fail', title: 'Erro rede cabeada', keywords: ['rede cabeada'], steps: ['Verifique cabo RJ45'] },
      { id: 'ip_dup', title: 'IP duplicado', keywords: ['ip duplicado'], steps: ['Configure IP fixo ou DHCP'] },
      { id: 'driver_missing', title: 'Driver não instalado', keywords: ['driver'], steps: ['Baixe do site oficial'] },
      { id: 'share_fail', title: 'Erro compartilhamento', keywords: ['compartilhamento'], steps: ['Verifique permissões no Windows'] },
      { id: 'mobile_fail', title: 'Erro impressão móvel', keywords: ['mobile'], steps: ['Instale HP Smart ou Samsung Mobile Print'] },
      { id: 'wifi_loss', title: 'Perda Wi-Fi após desligar', keywords: ['perda wifi'], steps: ['Reserve IP fixo no roteador'] },
      { id: 'ping_fail', title: 'Ping responde mas não imprime', keywords: ['ping'], steps: ['Reinicie spooler de impressão'] },
      { id: 'offline', title: 'Erro: Impressora offline', keywords: ['offline'], steps: ['Retire e adicione impressora'] },
      { id: 'roller_fail', title: 'Rolinho não puxa papel', keywords: ['rolinho'], steps: ['Limpe ou troque rolete'] },
      { id: 'fuser_hot', title: 'Fusor superaquecendo', keywords: ['fusor quente'], steps: ['Desligue e aguarde esfriar'] },
      { id: 'noise', title: 'Ruído estranho', keywords: ['ruído'], steps: ['Verifique objeto preso'] },
      { id: 'scanner_fail', title: 'Scanner não funciona', keywords: ['scanner'], steps: ['Verifique cabo flat','Atualize driver TWAIN'] },
      { id: 'adf_fail', title: 'ADF não puxa originais', keywords: ['adf'], steps: ['Limpe roletes com álcool isopropílico'] },
      { id: 'cover_open', title: 'Erro tampa aberta', keywords: ['tampa aberta'], steps: ['Verifique travas e feche'] },
      { id: 'blinking', title: 'Luz piscando sem imprimir', keywords: ['luz piscando'], steps: ['Verifique painel e atolamentos ocultos'] },
      { id: 'overheat', title: 'Erro superaquecimento fusor', keywords: ['sobre aquecimento'], steps: ['Desligue e aguarde 15min'] },
      { id: 'panel_freeze', title: 'Painel travado', keywords: ['painel travado'], steps: ['Desligue da tomada por 1 min'] },
      { id: 'maint_parts', title: 'Erro peças manutenção', keywords: ['kit fusão','roletes'], steps: ['Reset de manutenção no menu técnico'] },
      { id: 'queue', title: 'Fila de impressão travada', keywords: ['fila','travada'], steps: ['Limpe spooler em serviços do Windows'] },
      { id: 'strange_chars', title: 'Imprime códigos estranhos', keywords: ['códigos','estranhos'], steps: ['Instale driver PCL ou PS'] },
      { id: 'slow_print', title: 'Documento demora a imprimir', keywords: ['demora'], steps: ['Use driver dedicado'] },
      { id: 'duplex_lost', title: 'Configuração duplex sumiu', keywords: ['duplex sumiu'], steps: ['Reinstale driver'] },
      { id: 'margin_fail', title: 'Imprime fora da margem', keywords: ['fora da margem'], steps: ['Ajuste formato de papel'] },
      { id: 'wrong_port', title: 'Erro porta incorreta', keywords: ['porta'], steps: ['Redefina porta de comunicação'] },
      { id: 'scan_email', title: 'Não digitaliza p/ e-mail', keywords: ['email'], steps: ['Configure servidor SMTP'] },
      { id: 'scan_network', title: 'Erro salvar digitalização', keywords: ['digitalização'], steps: ['Configure pasta compartilhada'] },
      { id: 'pdf_slow', title: 'PDF muito lento', keywords: ['pdf lento'], steps: ['Ative imprimir como imagem no Adobe Reader'] },
      { id: 'fw_outdated', title: 'Firmware desatualizado', keywords: ['firmware'], steps: ['Atualize firmware no site oficial'] }
    ];

    function getQueryParam(name){ try{ const url = new URL(window.location.href); return url.searchParams.get(name); }catch(e){ return null; } }

    function populateIssueSelect(){
      const sel = document.getElementById('issueSelect');
      KB.forEach(k => { const opt = document.createElement('option'); opt.value = k.id; opt.textContent = k.title; sel.appendChild(opt); });
      const other = document.createElement('option'); other.value='other'; other.textContent='Outro (digitar)'; sel.appendChild(other);
    }

    function findKBById(id){ return KB.find(k=>k.id===id); }
    function findMatches(text){ if(!text) return []; const t=text.toLowerCase(); return KB.filter(k => k.keywords.some(w=>t.includes(w))); }

    const issueSelect=document.getElementById('issueSelect');
    const customIssue=document.getElementById('customIssue');
    const searchBtn=document.getElementById('searchBtn');
    const clearBtn=document.getElementById('clearBtn');
    const result=document.getElementById('result');
    const matchTitle=document.getElementById('matchTitle');
    const matchSteps=document.getElementById('matchSteps');
    const callActions=document.getElementById('callActions');
    const openSN=document.getElementById('openSN');
    const resolvedYes=document.getElementById('resolvedYes');
    const resolvedNo=document.getElementById('resolvedNo');
    const obsInput=document.getElementById('obs');
    const printerInfoElem=document.getElementById('printerInfo');

    let currentMatch=null;
    let currentPrinter=getQueryParam('printer')||'';
    if(currentPrinter){ printerInfoElem.textContent='Impressora: '+currentPrinter; } else { printerInfoElem.style.display='none'; }

    populateIssueSelect();

    searchBtn.addEventListener('click',()=>{
      const selVal=issueSelect.value; const custom=(customIssue.value||'').trim(); let matches=[];
      if(selVal&&selVal!=='other'){ const k=findKBById(selVal); if(k) matches=[k]; }
      else if(custom){ matches=findMatches(custom); }
      if(matches.length>0){ const m=matches[0]; matchTitle.textContent=m.title; matchSteps.innerHTML='<ol class="steps">'+m.steps.map(s=>'<li>'+s+'</li>').join('')+'</ol>'; currentMatch=m; }
      else if(custom){ matchTitle.textContent='Solução genérica'; matchSteps.innerHTML='<li>Desligue a impressora</li><li>Verifique cabos e papel</li>'; }
      result.style.display='block'; callActions.style.display='none';
    });

    clearBtn.addEventListener('click',()=>{ issueSelect.value=''; customIssue.value=''; result.style.display='none'; currentMatch=null; });
    resolvedYes.addEventListener('click',()=>{ alert('Que bom! Marcado como resolvido.'); });
    resolvedNo.addEventListener('click',()=>{ callActions.style.display='block'; obsInput.focus(); });
    openSN.addEventListener('click',()=>{ const issueText=(customIssue.value||'').trim()||(currentMatch?currentMatch.title:'Problema informado'); const shortDesc=`Chamado - ${currentPrinter||'IMP_NA'} - ${issueText}`; const longDesc=`Impressora: ${currentPrinter||'NA'}\nProblema: ${issueText}\nObs: ${obsInput.value||''}`; const url=SERVICENOW_URL+`?short_description=`+encodeURIComponent(shortDesc)+`&description=`+encodeURIComponent(longDesc); window.open(url,'_blank'); });
  </script>
</body>
</html>